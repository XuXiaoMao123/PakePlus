"use strict";(self["webpackChunktool_vue2"]=self["webpackChunktool_vue2"]||[]).push([[664],{48355:(e,r,t)=>{t.d(r,{u:()=>h});var a=t(90208),n=t(59258),i=t(78676),s=t(54119),c=t(20908),o=t(3604),u=t(30388),f=t(25026),l=t(69492),d=(t(16280),t(76918),t(28706),t(51629),t(23418),t(74423),t(62062),t(44114),t(26910),t(54743),t(11745),t(38309),t(16573),t(78100),t(77936),t(23288),t(62010),t(18111),t(7588),t(61701),t(26099),t(58940),t(27495),t(31415),t(17642),t(58004),t(33853),t(45876),t(32475),t(15024),t(31698),t(21699),t(47764),t(71761),t(11392),t(42762),t(23500),t(62953),t(3296),t(27208),t(48408),t(14603),t(47566),t(98721),t(46283)),h=function(){function e(){(0,f.A)(this,e)}return(0,l.A)(e,[{key:"mergePdfs",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,a,n,i,s,u,f,l,h,v=arguments;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return v.length>1&&void 0!==v[1]?v[1]:{},e.p=1,e.n=2,d.PDFDocument.create();case 2:t=e.v,a=(0,o.A)(r),e.p=3,a.s();case 4:if((n=a.n()).done){e.n=9;break}return i=n.value,e.n=5,this.readFileAsArrayBuffer(i);case 5:return s=e.v,e.n=6,d.PDFDocument.load(s);case 6:return u=e.v,e.n=7,t.copyPages(u,u.getPageIndices());case 7:f=e.v,f.forEach(function(e){t.addPage(e)});case 8:e.n=4;break;case 9:e.n=11;break;case 10:e.p=10,l=e.v,a.e(l);case 11:return e.p=11,a.f(),e.f(11);case 12:return e.n=13,t.save();case 13:return e.a(2,e.v);case 14:throw e.p=14,h=e.v,console.error("合并PDF失败:",h),new Error("合并PDF失败: "+h.message);case 15:return e.a(2)}},e,this,[[3,10,11,12],[1,14]])}));function r(r){return e.apply(this,arguments)}return r}()},{key:"addWatermark",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r,t){var a,n,i;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,this.readFileAsArrayBuffer(r);case 1:return a=e.v,e.n=2,d.PDFDocument.load(a);case 2:return n=e.v,e.n=3,n.save();case 3:return e.a(2,e.v);case 4:throw e.p=4,i=e.v,console.error("添加水印失败:",i),new Error("添加水印失败: "+i.message);case 5:return e.a(2)}},e,this,[[0,4]])}));function r(r,t){return e.apply(this,arguments)}return r}()},{key:"imagesToPdf",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,a,n=arguments;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return n.length>1&&void 0!==n[1]?n[1]:{},e.p=1,e.n=2,d.PDFDocument.create();case 2:return t=e.v,e.n=3,t.save();case 3:return e.a(2,e.v);case 4:throw e.p=4,a=e.v,console.error("图片转PDF失败:",a),new Error("图片转PDF失败: "+a.message);case 5:return e.a(2)}},e,null,[[1,4]])}));function r(r){return e.apply(this,arguments)}return r}()},{key:"compressPdf",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,a,n,i,s=arguments;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return s.length>1&&void 0!==s[1]?s[1]:{},e.p=1,e.n=2,this.readFileAsArrayBuffer(r);case 2:return t=e.v,e.n=3,d.PDFDocument.load(t);case 3:return a=e.v,e.n=4,a.save();case 4:return n=e.v,e.a(2,{data:n,originalSize:r.size,compressedSize:n.length});case 5:throw e.p=5,i=e.v,console.error("PDF压缩失败:",i),new Error("PDF压缩失败: "+i.message);case 6:return e.a(2)}},e,this,[[1,5]])}));function r(r){return e.apply(this,arguments)}return r}()}],[{key:"readFileAsArrayBuffer",value:function(e){return new Promise(function(r,t){try{if(!e)return void t(new Error("文件对象为空"));if(e instanceof ArrayBuffer)return void r(e);if(e instanceof Blob||e instanceof File){var a=new FileReader;return a.onload=function(){return r(a.result)},a.onerror=function(e){return t(e||new Error("读取文件失败"))},void a.readAsArrayBuffer(e)}if("function"===typeof e.arrayBuffer)return void e.arrayBuffer().then(r)["catch"](function(e){return t(e||new Error("调用arrayBuffer方法失败"))});t(new Error("不支持的文件类型: ".concat((0,s.A)(e))))}catch(n){t(n||new Error("读取文件时发生未知错误"))}})}},{key:"processFileInfo",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,a,n,i,s;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:if(e.p=0,t=r._file,t){e.n=1;break}throw new Error("无法访问文件");case 1:return e.n=2,this.readFileAsArrayBuffer(t);case 2:return a=e.v,e.n=3,d.PDFDocument.load(a,{ignoreEncryption:!0,throwOnInvalidObject:!1});case 3:return n=e.v,i=n.getPageCount(),e.a(2,{pageCount:i,pageRange:"1-".concat(i),error:null});case 4:return e.p=4,s=e.v,e.a(2,{pageCount:0,pageRange:"",error:"处理文件失败: ".concat(s.message||"未知错误")})}},e,this,[[0,4]])}));function r(r){return e.apply(this,arguments)}return r}()},{key:"generatePreview",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,a,n,s,o,u,f,l,h,v;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:if(e.p=0,t=r._file,t){e.n=1;break}throw new Error("无法访问文件");case 1:return e.n=2,this.readFileAsArrayBuffer(t);case 2:return a=e.v,e.n=3,d.PDFDocument.load(a,{ignoreEncryption:!0,throwOnInvalidObject:!1});case 3:return n=e.v,e.n=4,d.PDFDocument.create();case 4:return s=e.v,e.n=5,s.copyPages(n,[0]);case 5:return o=e.v,u=(0,i.A)(o,1),f=u[0],s.addPage(f),e.n=6,s.save();case 6:return l=e.v,h=new Blob([l],{type:"application/pdf"}),e.a(2,URL.createObjectURL(h));case 7:return e.p=7,v=e.v,console.error("生成预览时发生错误:",v),e.a(2,null)}},e,this,[[0,7]])}));function r(r){return e.apply(this,arguments)}return r}()},{key:"parsePageRange",value:function(e,r){if(!e||!r)return(0,n.A)(Array(r)).map(function(e,r){return r});var t,a=new Set,s=e.split(","),c=(0,o.A)(s);try{for(c.s();!(t=c.n()).done;){var u=t.value,f=u.trim();if(f)if(f.includes("-")){var l=f.split("-").map(function(e){return parseInt(e.trim())}),d=(0,i.A)(l,2),h=d[0],v=d[1];if(!isNaN(h)&&!isNaN(v))for(var g=Math.max(1,h);g<=Math.min(r,v);g++)a.add(g-1)}else{var p=parseInt(f);!isNaN(p)&&p>=1&&p<=r&&a.add(p-1)}}}catch(m){c.e(m)}finally{c.f()}return Array.from(a).sort(function(e,r){return e-r})}},{key:"adjustPageSize",value:function(e,r,t,a,n){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if((r!==a||t!==n)&&(e.setSize(a,n),i)){var s=a/r,c=n/t,o=Math.min(s,c),u=(a-r*o)/2,f=(n-t*o)/2;e.scale(o,o),e.translateContent(u,f)}}},{key:"findLargestPageSize",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,a,n,i,s,u,f,l,h,v,g,p,m,w,A;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:t=0,a=0,n=(0,o.A)(r),e.p=1,n.s();case 2:if((i=n.n()).done){e.n=9;break}if(s=i.value,e.p=3,s&&s._file){e.n=4;break}return e.a(3,8);case 4:return e.n=5,this.readFileAsArrayBuffer(s._file);case 5:return u=e.v,e.n=6,d.PDFDocument.load(u,{ignoreEncryption:!0,throwOnInvalidObject:!1});case 6:for(f=e.v,l=f.getPageCount(),h=0;h<l;h++)v=f.getPage(h),g=v.getSize(),p=g.width,m=g.height,t=Math.max(t,p),a=Math.max(a,m);e.n=8;break;case 7:e.p=7,w=e.v,console.error("获取文件尺寸时出错:",w);case 8:e.n=2;break;case 9:e.n=11;break;case 10:e.p=10,A=e.v,n.e(A);case 11:return e.p=11,n.f(),e.f(11);case 12:return e.a(2,{maxWidth:t,maxHeight:a})}},e,this,[[3,7],[1,10,11,12]])}));function r(r){return e.apply(this,arguments)}return r}()},{key:"addPageNumbers",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r,t){var a,n,i,s,o,u,f,l,h,v,g,p,m,w,A=arguments;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:a=A.length>2&&void 0!==A[2]?A[2]:1,n=A.length>3&&void 0!==A[3]?A[3]:"bottom-center",i=r.getPages(),s=0;case 1:if(!(s<i.length)){e.n=11;break}o=i[s],u=o.getSize(),f=u.width,l=u.height,h=a+s,v="".concat(h),g=t.widthOfTextAtSize(v,10),p=void 0,m=void 0,w=n,e.n="bottom-center"===w?2:"bottom-right"===w?3:"bottom-left"===w?4:"top-center"===w?5:"top-right"===w?6:"top-left"===w?7:8;break;case 2:return p=(f-g)/2,m=20,e.a(3,9);case 3:return p=f-g-20,m=20,e.a(3,9);case 4:return p=20,m=20,e.a(3,9);case 5:return p=(f-g)/2,m=l-20,e.a(3,9);case 6:return p=f-g-20,m=l-20,e.a(3,9);case 7:return p=20,m=l-20,e.a(3,9);case 8:p=(f-g)/2,m=20;case 9:o.drawText(v,{x:p,y:m,size:10,font:t,color:(0,d.rgb)(0,0,0)});case 10:s++,e.n=1;break;case 11:return e.a(2)}},e)}));function r(r,t){return e.apply(this,arguments)}return r}()},{key:"mergePDFs",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r,t){var a,i,s,o,u,f,l,h,v,g,p,m,w,A,y,P,b,k,F,x,D,z,S,E,I,C,_,B,T,W;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return e.n=1,d.PDFDocument.create();case 1:if(a=e.v,!t.addPageNumbers){e.n=3;break}return e.n=2,a.embedFont(d.StandardFonts.Helvetica);case 2:i=e.v;case 3:if(t.setMetadata&&(a.setTitle(t.title||"合并文档"),t.author&&a.setAuthor(t.author),a.setCreationDate(new Date),a.setModificationDate(new Date)),s=[],o=0,u=!1,f=595,l=842,"standardize"!==t.pageSizeHandling){e.n=9;break}T=t.standardPageSize,e.n="A3"===T?4:"A5"===T?5:"LETTER"===T?6:"LEGAL"===T?7:8;break;case 4:return f=842,l=1191,e.a(3,8);case 5:return f=420,l=595,e.a(3,8);case 6:return f=612,l=792,e.a(3,8);case 7:return f=612,l=1008,e.a(3,8);case 8:"landscape"===t.pageOrientation&&(h=[l,f],f=h[0],l=h[1]);case 9:if(v=0,g=0,"largest"!==t.pageSizeHandling){e.n=11;break}return e.n=10,this.findLargestPageSize(r);case 10:p=e.v,v=p.maxWidth,g=p.maxHeight;case 11:m=0;case 12:if(!(m<r.length)){e.n=24;break}if(e.p=13,w=r[m],w&&w._file){e.n=14;break}return e.a(3,23);case 14:return A=w.name||"文件_".concat(m+1),e.n=15,this.readFileAsArrayBuffer(w._file);case 15:if(y=e.v,y&&0!==y.byteLength){e.n=16;break}return e.a(3,23);case 16:return e.n=17,d.PDFDocument.load(y,{ignoreEncryption:!0,throwOnInvalidObject:!1});case 17:if(P=e.v,b=P.getPageCount(),0!==b){e.n=18;break}return e.a(3,23);case 18:if(k=w.pageRange?this.parsePageRange(w.pageRange,b):(0,n.A)(Array(b)).map(function(e,r){return r}),0!==k.length){e.n=19;break}return e.a(3,23);case 19:return e.n=20,a.copyPages(P,k);case 20:if(F=e.v,F&&0!==F.length){e.n=21;break}return e.a(3,23);case 21:for(x=o,D=0;D<F.length;D++)z=F[D],0!==w.rotation&&z.setRotation((0,d.degrees)(w.rotation)),S=z.getSize(),E=S.width,I=S.height,"largest"===t.pageSizeHandling&&v>0&&g>0?this.adjustPageSize(z,E,I,v,g,t.fitToPage):"standardize"===t.pageSizeHandling&&(C=f,_=l,"auto"===t.pageOrientation&&(B=E>I,B&&f<l&&(C=l,_=f)),this.adjustPageSize(z,E,I,C,_,t.fitToPage)),a.addPage(z),o++;t.outlineFromFilenames&&F.length>0&&s.push({title:A,pageRef:a.getPage(x).ref}),u=!0,e.n=23;break;case 22:e.p=22,W=e.v,console.error("处理文件时发生错误:",W);case 23:m++,e.n=12;break;case 24:if(u&&0!==o){e.n=25;break}throw new Error("没有可合并的有效PDF文件");case 25:if(s.length>0&&a.outline)try{a.outline.children=s}catch(c){console.error("设置PDF书签时发生错误:",c)}if(!t.addPageNumbers){e.n=26;break}return e.n=26,this.addPageNumbers(a,i,t.startPageNumber,t.pageNumbersPosition);case 26:return e.n=27,a.save();case 27:return e.a(2,e.v)}},e,this,[[13,22]])}));function r(r,t){return e.apply(this,arguments)}return r}()},{key:"parseColor",value:function(e){if(e.startsWith("#")){var r=e.substring(1),t=parseInt(r.substring(0,2),16)/255,a=parseInt(r.substring(2,4),16)/255,n=parseInt(r.substring(4,6),16)/255;return{r:t,g:a,b:n}}if(e.startsWith("rgb")){var i=e.match(/\d+/g);if(i&&i.length>=3)return{r:parseInt(i[0])/255,g:parseInt(i[1])/255,b:parseInt(i[2])/255}}return{r:1,g:0,b:0}}},{key:"calculateWatermarkPosition",value:function(e,r,t,a,n,i){var s,c,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,f=t.horizontalOffset||0,l=t.verticalOffset||0,d=0,h=0;if("text"===t.type&&a&&n){var v=a.widthOfTextAtSize(n,i),g=a.heightAtSize(i);d=v,h=g}else"image"===t.type&&(d=o,h=u);switch(t.horizontalPosition){case"left":s=20+f;break;case"right":s=e-d-20+f;break;case"center":default:s=(e-d)/2+f;break}switch(t.verticalPosition){case"top":c=r-h-20+l;break;case"bottom":c=20+l;break;case"center":default:c=(r-h)/2+l;break}return{x:s,y:c}}},{key:"generateWatermarkPositions",value:function(e,r,t,a,n,i){var s=[],c=t.density||"single";if("single"===c){var o=this.calculateWatermarkPosition(e,r,t,a,n,i);s.push(o)}else{var u=0,f=0;if(a&&n&&(u=a.widthOfTextAtSize(n,i),f=a.heightAtSize(i)),"grid"===c)for(var l=3,d=3,h=e/l,v=r/d,g=0;g<d;g++)for(var p=0;p<l;p++)s.push({x:p*h+(h-u)/2,y:g*v+(v-f)/2});else if("diagonal"===c)for(var m=2*Math.max(u,f),w=Math.ceil(Math.max(e,r)/m),A=0;A<w;A++){var y=A*m,P=A*m;y<e&&P<r&&s.push({x:y,y:P})}else if("dense"===c)for(var b=5,k=5,F=e/b,x=r/k,D=0;D<k;D++)for(var z=0;z<b;z++)s.push({x:z*F+(F-u)/2,y:D*x+(x-f)/2})}return s}},{key:"generateImageWatermarkPositions",value:function(e,r,t,a,n){var i=[],s=t.density||"single";if("single"===s){var c=this.calculateWatermarkPosition(e,r,t,null,null,null,a,n);i.push(c)}else if("grid"===s)for(var o=3,u=3,f=e/o,l=r/u,d=0;d<u;d++)for(var h=0;h<o;h++)i.push({x:h*f+(f-a)/2,y:d*l+(l-n)/2});else if("diagonal"===s)for(var v=2*Math.max(a,n),g=Math.ceil(Math.max(e,r)/v),p=0;p<g;p++){var m=p*v,w=p*v;m<e&&w<r&&i.push({x:m,y:w})}else if("dense"===s)for(var A=5,y=5,P=e/A,b=r/y,k=0;k<y;k++)for(var F=0;F<A;F++)i.push({x:F*P+(P-a)/2,y:k*b+(b-n)/2});return i}},{key:"addTextWatermark",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r,t,a){var n,i,s,u,f,l,h,v,g,p,m,w,A,y,P,b;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:e.p=0,P=a.fontFamily,e.n="times"===P?1:"courier"===P?3:5;break;case 1:return e.n=2,r.embedFont(d.StandardFonts.TimesRoman);case 2:return n=e.v,e.a(3,7);case 3:return e.n=4,r.embedFont(d.StandardFonts.Courier);case 4:return n=e.v,e.a(3,7);case 5:return e.n=6,r.embedFont(d.StandardFonts.Helvetica);case 6:return n=e.v,e.a(3,7);case 7:e.n=10;break;case 8:return e.p=8,b=e.v,console.warn("无法加载指定字体，使用默认字体:",b),e.n=9,r.embedFont(d.StandardFonts.Helvetica);case 9:n=e.v;case 10:i=this.parseColor(a.color),s=(0,o.A)(t);try{for(s.s();!(u=s.n()).done;){f=u.value,l=r.getPage(f),h=l.getSize(),v=h.width,g=h.height,p=this.generateWatermarkPositions(v,g,a,n,a.text,a.fontSize),m=(0,o.A)(p);try{for(m.s();!(w=m.n()).done;){A=w.value;try{l.drawText(a.text,{x:A.x,y:A.y,size:a.fontSize,font:n,color:(0,d.rgb)(i.r,i.g,i.b),opacity:a.opacity,rotate:(0,d.degrees)(a.rotation||0)})}catch(c){console.warn("页面 ".concat(f+1," 位置 (").concat(A.x,", ").concat(A.y,") 添加文字水印失败:"),c),y="WATERMARK",l.drawText(y,{x:A.x,y:A.y,size:a.fontSize,font:n,color:(0,d.rgb)(i.r,i.g,i.b),opacity:a.opacity,rotate:(0,d.degrees)(a.rotation||0)})}}}catch(k){m.e(k)}finally{m.f()}}}catch(k){s.e(k)}finally{s.f()}case 11:return e.a(2)}},e,this,[[0,8]])}));function r(r,t,a){return e.apply(this,arguments)}return r}()},{key:"addImageWatermark",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r,t,a){var n,i,s,u,f,l,h,v,g,p,m,w,A,y,P;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return e.n=1,this.readFileAsArrayBuffer(a.imageFile);case 1:if(n=e.v,"image/jpeg"!==a.imageFile.type&&"image/jpg"!==a.imageFile.type){e.n=3;break}return e.n=2,r.embedJpg(n);case 2:i=e.v,e.n=6;break;case 3:if("image/png"!==a.imageFile.type){e.n=5;break}return e.n=4,r.embedPng(n);case 4:i=e.v,e.n=6;break;case 5:throw new Error("不支持的图片格式，请使用 JPG 或 PNG 格式");case 6:s=(0,o.A)(t);try{for(s.s();!(u=s.n()).done;){f=u.value,l=r.getPage(f),h=l.getSize(),v=h.width,g=h.height,p=a.imageWidth||100,m=i.height/i.width*p,w=this.generateImageWatermarkPositions(v,g,a,p,m),A=(0,o.A)(w);try{for(A.s();!(y=A.n()).done;)P=y.value,l.drawImage(i,{x:P.x,y:P.y,width:p,height:m,opacity:a.opacity,rotate:(0,d.degrees)(a.rotation||0)})}catch(c){A.e(c)}finally{A.f()}}}catch(c){s.e(c)}finally{s.f()}case 7:return e.a(2)}},e,this)}));function r(r,t,a){return e.apply(this,arguments)}return r}()},{key:"processWatermark",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r,t){var a,n,i,s,o;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:if(a=r._file,a){e.n=1;break}throw new Error("文件 ".concat(r.name," 无法访问"));case 1:return e.n=2,this.readFileAsArrayBuffer(a);case 2:return n=e.v,e.n=3,d.PDFDocument.load(n,{ignoreEncryption:!0,throwOnInvalidObject:!1});case 3:if(i=e.v,s=i.getPageCount(),o=Array.from({length:s},function(e,r){return r}),"text"!==t.type){e.n=5;break}return e.n=4,this.addTextWatermark(i,o,t);case 4:e.n=6;break;case 5:if("image"!==t.type){e.n=6;break}return e.n=6,this.addImageWatermark(i,o,t);case 6:return e.n=7,i.save();case 7:return e.a(2,e.v)}},e,this)}));function r(r,t){return e.apply(this,arguments)}return r}()},{key:"mergeWatermarkedFiles",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,a,n,i,s,u,f,l;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return e.n=1,d.PDFDocument.create();case 1:t=e.v,a=(0,o.A)(r),e.p=2,a.s();case 3:if((n=a.n()).done){e.n=8;break}if(i=n.value,!i.watermarkedBlob){e.n=7;break}return e.n=4,this.readFileAsArrayBuffer(i.watermarkedBlob);case 4:return s=e.v,e.n=5,d.PDFDocument.load(s);case 5:return u=e.v,e.n=6,t.copyPages(u,u.getPageIndices());case 6:f=e.v,f.forEach(function(e){return t.addPage(e)});case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,l=e.v,a.e(l);case 10:return e.p=10,a.f(),e.f(10);case 11:return e.n=12,t.save();case 12:return e.a(2,e.v)}},e,this,[[2,9,10,11]])}));function r(r){return e.apply(this,arguments)}return r}()},{key:"splitPdf",value:function(){var e=(0,u.A)((0,c.A)().m(function e(r){var t,n,s,u,f,l,h,v,g,p,m,w,A,y,P,b,k,F,x,D,z=arguments;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:return t=z.length>1&&void 0!==z[1]?z[1]:{},e.p=1,e.n=2,this.readFileAsArrayBuffer(r);case 2:return n=e.v,e.n=3,d.PDFDocument.load(n);case 3:if(s=e.v,u=[],"range"!==t.method){e.n=11;break}f=t.ranges,l=(0,o.A)(f),e.p=4,v=(0,c.A)().m(function e(){var r,a,n,o,f,l,v,g,p,m;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:for(r=h.value,a=(0,i.A)(r,2),n=a[0],o=a[1],f=[],l=n-1;l<o;l++)f.push(l);return e.n=1,d.PDFDocument.create();case 1:return v=e.v,e.n=2,v.copyPages(s,f);case 2:return g=e.v,g.forEach(function(e){v.addPage(e)}),e.n=3,v.save();case 3:p=e.v,m="".concat(t.filenamePrefix||"split","_").concat(n,"-").concat(o,".pdf"),u.push({name:m,data:p,size:p.length});case 4:return e.a(2)}},e)}),l.s();case 5:if((h=l.n()).done){e.n=7;break}return e.d((0,a.A)(v()),6);case 6:e.n=5;break;case 7:e.n=9;break;case 8:e.p=8,x=e.v,l.e(x);case 9:return e.p=9,l.f(),e.f(9);case 10:e.n=20;break;case 11:if("count"!==t.method){e.n=15;break}g=s.getPageCount(),p=t.pagesPerFile,m=0,w=1,A=(0,c.A)().m(function e(){var r,a,n,i,o,f,l;return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:for(r=Math.min(m+p,g),a=[],n=m;n<r;n++)a.push(n);return e.n=1,d.PDFDocument.create();case 1:return i=e.v,e.n=2,i.copyPages(s,a);case 2:return o=e.v,o.forEach(function(e){i.addPage(e)}),e.n=3,i.save();case 3:f=e.v,l="".concat(t.filenamePrefix||"split","_part").concat(w,".pdf"),u.push({name:l,data:f,size:f.length}),m=r,w++;case 4:return e.a(2)}},e)});case 12:if(!(m<g)){e.n=14;break}return e.d((0,a.A)(A()),13);case 13:e.n=12;break;case 14:e.n=20;break;case 15:if("extract"!==t.method){e.n=19;break}return y=t.pages.map(function(e){return e-1}),e.n=16,d.PDFDocument.create();case 16:return P=e.v,e.n=17,P.copyPages(s,y);case 17:return b=e.v,b.forEach(function(e){P.addPage(e)}),e.n=18,P.save();case 18:k=e.v,F="".concat(t.filenamePrefix||"extracted","_pages.pdf"),u.push({name:F,data:k,size:k.length}),e.n=20;break;case 19:if("bookmark"!==t.method){e.n=20;break}throw new Error("按书签拆分功能暂未实现");case 20:return e.a(2,u);case 21:throw e.p=21,D=e.v,console.error("PDF拆分失败:",D),new Error("PDF拆分失败: "+D.message);case 22:return e.a(2)}},e,this,[[4,8,9,10],[1,21]])}));function r(r){return e.apply(this,arguments)}return r}()}])}()},56583:(e,r,t)=>{t.d(r,{A:()=>c});var a=t(20908),n=t(3604),i=t(30388),s=(t(23418),t(44114),t(26099),t(47764),t(5279));t(34345);const c={pdfToImages:function(e){var r=arguments;return(0,i.A)((0,a.A)().m(function t(){var i,c,o,u,f,l,d,h,v,g,p,m,w,A,y,P,b,k,F,x,D,z;return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:return i=r.length>1&&void 0!==r[1]?r[1]:{},c=i.format,o=void 0===c?"png":c,u=i.dpi,f=void 0===u?150:u,l=i.pages,d=void 0===l?[]:l,h=new FileReader,t.n=1,new Promise(function(r,t){h.onload=function(){return r(h.result)},h.onerror=t,h.readAsArrayBuffer(e)});case 1:return v=t.v,t.n=2,s.getDocument({data:v}).promise;case 2:g=t.v,p=g.numPages,m=d.length>0?d:Array.from({length:p},function(e,r){return r+1}),w=[],A=(0,n.A)(m),t.p=3,A.s();case 4:if((y=A.n()).done){t.n=9;break}if(P=y.value,!(P<1||P>p)){t.n=5;break}return t.a(3,8);case 5:return t.n=6,g.getPage(P);case 6:return b=t.v,k=b.getViewport({scale:f/72}),F=document.createElement("canvas"),x=F.getContext("2d"),F.width=k.width,F.height=k.height,t.n=7,b.render({canvasContext:x,viewport:k}).promise;case 7:D=F.toDataURL("image/".concat(o)),w.push({page:P,dataUrl:D,width:F.width,height:F.height});case 8:t.n=4;break;case 9:t.n=11;break;case 10:t.p=10,z=t.v,A.e(z);case 11:return t.p=11,A.f(),t.f(11);case 12:return t.a(2,w)}},t,null,[[3,10,11,12]])}))()}}},79616:(e,r,t)=>{t.r(r),t.d(r,{default:()=>m});var a=function(){var e=this,r=e._self._c;return r("main",{staticClass:"container mx-auto px-4 py-8 max-w-4xl"},[e._m(0),r("pdf-function-selector",{attrs:{"active-function":e.activeFunction},on:{select:e.selectFunction}}),r("div",{staticClass:"bg-white dark:bg-neutral-800 rounded-xl shadow-custom p-6 mb-8"},["merge"===e.activeFunction?r("pdf-merge-panel"):"watermark"===e.activeFunction?r("pdf-watermark-panel"):"toImage"===e.activeFunction?r("pdf-to-image-panel"):"fromImage"===e.activeFunction?r("image-to-pdf-panel"):"compress"===e.activeFunction?r("pdf-compress-panel"):"split"===e.activeFunction?r("pdf-split-panel"):r("div",{staticClass:"text-center py-12"},[r("i",{staticClass:"fa fa-tools text-4xl text-neutral-400 dark:text-neutral-500 mb-4"}),r("h3",{staticClass:"text-xl font-semibold text-neutral-900 dark:text-white mb-2"},[e._v(" "+e._s(e.getFunctionTitle(e.activeFunction))+" ")]),r("p",{staticClass:"text-neutral-600 dark:text-neutral-300"},[e._v(" 该功能正在开发中，敬请期待... ")])])],1),r("pdf-instructions")],1)},n=[function(){var e=this,r=e._self._c;return r("div",{staticClass:"mb-8 flex items-center"},[r("i",{staticClass:"fa fa-file-pdf text-3xl md:text-4xl text-red-500 dark:text-red-400 mr-3"}),r("div",[r("h1",{staticClass:"text-2xl md:text-3xl font-bold text-primary dark:text-primary-400 mb-1"},[e._v("PDF工具箱")]),r("p",{staticClass:"text-neutral-600 dark:text-neutral-300 text-base"},[e._v(" 在线处理PDF文件，支持多种常用PDF操作，简单高效。 ")])])])}],i=t(89634),s=t(982),c=t(17331),o=t(27039),u=t(80467),f=t(11653),l=t(70231),d=t(47111);const h={name:"PdfTools",components:{PdfFunctionSelector:i.A,PdfMergePanel:s.A,PdfWatermarkPanel:c.A,PdfInstructions:o.A,PdfToImagePanel:u.A,ImageToPdfPanel:f.A,PdfCompressPanel:l.A,PdfSplitPanel:d.A},data:function(){return{activeFunction:"merge"}},mounted:function(){this.activeFunction="merge"},methods:{selectFunction:function(e){this.activeFunction=e},getFunctionTitle:function(e){var r={merge:"PDF合并",split:"PDF拆分",toImage:"PDF转图片",fromImage:"图片转PDF",compress:"PDF压缩",watermark:"添加水印"};return r[e]||"PDF工具"}}},v=h;var g=t(81656),p=(0,g.A)(v,a,n,!1,null,"532371e2",null);const m=p.exports}}]);